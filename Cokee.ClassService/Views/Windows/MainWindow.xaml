<Window
    x:Class="Cokee.ClassService.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Controls="clr-namespace:Cokee.ClassService.Views.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:emoji="http://schemas.inkore.net/lib/ui/wpf/emojis"
    xmlns:helper="clr-namespace:Cokee.ClassService.Helper"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:ui="http://schemas.inkore.net/lib/ui/wpf/modern"
    xmlns:uix="http://schemas.inkore.net/lib/ui/wpf"
    Title="ClassService"
    Width="1920"
    Height="1080"
    ui:ThemeManager.IsThemeAware="True"
    AllowsTransparency="True"
    Background="{x:Null}"
    Closed="Window_Closed"
    Closing="Window_Closing"
    Focusable="False"
    FontSize="16"
    KeyDown="MainWindow_OnKeyDown"
    Left="0"
    Loaded="Window_Loaded"
    ResizeMode="NoResize"
    ShowInTaskbar="False"
    SnapsToDevicePixels="True"
    Stylus.IsPressAndHoldEnabled="True"
    Top="0"
    Topmost="True"
    WindowStartupLocation="CenterScreen"
    WindowState="Normal"
    WindowStyle="None"
    mc:Ignorable="d">
    <Grid x:Name="MainGrid" Focusable="False">

        <Grid x:Name="inkGrid">
            <InkCanvas
                x:Name="inkcanvas"
                Focusable="False"
                IsEnabled="False">
                <InkCanvas.DefaultDrawingAttributes>
                    <DrawingAttributes
                        Width="3.5"
                        Height="3.5"
                        Color="Red" />
                </InkCanvas.DefaultDrawingAttributes>
                <InkCanvas.Background>
                    <SolidColorBrush Opacity="0.00" Color="White" />
                </InkCanvas.Background>
            </InkCanvas>
            <Grid
                x:Name="pptControls"
                d:Visibility="Visible"
                Focusable="False"
                Visibility="Collapsed">
                <TextBlock
                    HorizontalAlignment="Left"
                    VerticalAlignment="Top"
                    Focusable="False"
                    FontSize="28"
                    FontWeight="Bold"
                    Foreground="#7F808080"
                    Text="{Binding Text, ElementName=VerStr}" />
                <Border
                    Padding="0"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"
                    Focusable="False"
                    Style="{StaticResource CardBorderStyle}">
                    <Grid Margin="2" Focusable="False">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Button
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Click="PptUp"
                            Focusable="False"
                            FontSize="20">
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.ArrowUp_48_Regular}" />
                        </Button>
                        <TextBlock
                            x:Name="pptPage"
                            Grid.Row="1"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            Focusable="False"
                            FontFamily="Lato"
                            TextAlignment="Center"><Run
                                x:Name="NowPageText"
                                FontSize="12"
                                Text="11" /><LineBreak /><Run FontSize="8" Text="————" /><LineBreak /><Run
                                x:Name="TotalPageText"
                                FontSize="12"
                                Text="123" /></TextBlock>
                        <Button
                            Grid.Row="2"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Click="PptDown"
                            Focusable="False"
                            FontSize="20">
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.ArrowDown_48_Regular}" />
                        </Button>
                    </Grid>
                </Border>
                <Border
                    Padding="0"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"
                    Focusable="False"
                    Style="{StaticResource CardBorderStyle}">
                    <Grid Margin="2" Focusable="False">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                            <RowDefinition Height="*" />
                        </Grid.RowDefinitions>
                        <Button
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Click="PptUp"
                            Focusable="False"
                            FontSize="20">
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.ArrowUp_48_Regular}" />
                        </Button>
                        <TextBlock
                            x:Name="pptPage1"
                            Grid.Row="1"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            Focusable="False"
                            FontFamily="Lato"
                            TextAlignment="Center"><Run FontSize="12" Text="{Binding Text, ElementName=NowPageText, Mode=OneWay}" /><LineBreak /><Run FontSize="8" Text="————" /><LineBreak /><Run FontSize="12" Text="{Binding Text, ElementName=TotalPageText, Mode=OneWay}" /></TextBlock>
                        <Button
                            Grid.Row="2"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Click="PptDown"
                            Focusable="False"
                            FontSize="20">
                            <ui:FontIcon Icon="{x:Static ui:FluentSystemIcons.ArrowDown_48_Regular}" />
                        </Button>
                    </Grid>
                </Border>
            </Grid>
            <Grid HorizontalAlignment="Center" VerticalAlignment="Bottom">
                <Controls:InkToolBar
                    x:Name="inkTool"
                    Grid.Column="1"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Bottom"
                    d:Visibility="Visible"
                    Background="#4C484848"
                    Focusable="False"
                    Visibility="Collapsed" />
            </Grid>
        </Grid>
        <Border
            x:Name="sideCard"
            Margin="0,0,5,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Center"
            d:Visibility="Visible"
            ui:ThemeManager.RequestedTheme="Dark"
            BorderThickness="2"
            CornerRadius="8"
            Visibility="Collapsed">

            <Border.Background>
                <VisualBrush>
                    <VisualBrush.Transform>
                        <TransformGroup>
                            <ScaleTransform CenterX="100" CenterY="10" ScaleX="1.5" ScaleY="1.5" />
                        </TransformGroup>
                    </VisualBrush.Transform>
                    <VisualBrush.Visual>
                        <Image
                            Opacity="1"
                            Source="/Resources/CardBackGround/1.png"
                            Stretch="Uniform">
                            <Image.Effect>
                                <BlurEffect Radius="1" />
                            </Image.Effect>
                        </Image>
                    </VisualBrush.Visual>
                </VisualBrush>
            </Border.Background>

            <Border.RenderTransform>
                <TranslateTransform x:Name="cardtran" d:X="300" X="300" />
            </Border.RenderTransform>
            <uix:SimpleStackPanel Margin="15" Spacing="5">
                <uix:SimpleStackPanel VerticalAlignment="Top">
                    <TextBlock
                        x:Name="time1"
                        Margin="0,0,0,5"
                        d:Text="21:03:03"
                        FontFamily="Lato"
                        FontSize="30"
                        Foreground="White"
                        Text="--:--">
                        <TextBlock.Effect>
                            <DropShadowEffect Opacity="0.3" />
                        </TextBlock.Effect>
                    </TextBlock>
                    <TextBlock
                        x:Name="longDate"
                        d:Text="2024年 周六 不知道什么节"
                        FontFamily="Lato"
                        FontSize="16"
                        Foreground="White"
                        Text="-----">
                        <TextBlock.Effect>
                            <DropShadowEffect Opacity="0.3" />
                        </TextBlock.Effect>
                    </TextBlock>
                    <TextBlock
                        x:Name="longCHNDate"
                        Margin="0,5,0,5"
                        d:Text="甲辰年(龙年)己巳月丙子日"
                        FontFamily="Lato"
                        FontSize="14"
                        Foreground="White">
                        <TextBlock.Effect>
                            <DropShadowEffect Opacity="0.3" />
                        </TextBlock.Effect>
                    </TextBlock>
                </uix:SimpleStackPanel>
                <uix:SimpleStackPanel>
                    <Grid x:Name="btnGrid">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition />
                            <ColumnDefinition />
                        </Grid.ColumnDefinitions>
                        <uix:SimpleStackPanel Margin="5" Spacing="5">
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="ShowRandom">
                                <ui:IconAndText Content="随机抽取" Icon="{x:Static ui:FluentSystemIcons.Cut_24_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="StuMgr">
                                <ui:IconAndText Content="学生管理" Icon="{x:Static ui:FluentSystemIcons.PeopleCommunity_20_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="StartInk">
                                <ui:IconAndText Content="快速批注" Icon="{x:Static ui:FluentSystemIcons.Pen_48_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="ScreenShot"
                                MouseRightButtonDown="Button_MouseRightButtonDown">
                                <ui:IconAndText Content="截图" Icon="{x:Static ui:FluentSystemIcons.Screenshot_24_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="CourseMgr"
                                Visibility="Collapsed">
                                <ui:IconAndText Content="课程管理" Icon="{x:Static ui:FluentSystemIcons.List_28_Regular}" />
                            </Button>
                        </uix:SimpleStackPanel>
                        <uix:SimpleStackPanel
                            Grid.Column="1"
                            Margin="5"
                            Spacing="5">
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="VolumeCard">
                                <ui:IconAndText Content="音量调节" Icon="{x:Static ui:FluentSystemIcons.Speaker2_28_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="AddFloatCard"
                                MouseRightButtonDown="UsbDebug">
                                <ui:IconAndText Content="桌面便签" Icon="{x:Static ui:FluentSystemIcons.NoteAdd_28_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="ShowStickys"
                                MouseRightButtonDown="PostNote">
                                <ui:IconAndText Content="梦想板" Icon="{x:Static ui:FluentSystemIcons.Notebook_32_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="Timer"
                                MouseRightButtonDown="Debug_RightBtn"
                                Visibility="Collapsed">
                                <ui:IconAndText Content="计时器" Icon="{x:Static ui:FluentSystemIcons.Clock_28_Regular}" />
                            </Button>
                            <Button
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                Click="OpenSettings"
                                MouseRightButtonDown="QuickFix">
                                <ui:IconAndText Content="设置" Icon="{x:Static ui:FluentSystemIcons.Settings_32_Regular}" />
                            </Button>
                        </uix:SimpleStackPanel>
                    </Grid>
                    <Button
                        Width="104"
                        Height="32"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Stretch"
                        Click="MonitorOff"
                        Visibility="Collapsed">
                        <ui:IconAndText Content="休眠" Icon="{x:Static ui:FluentSystemIcons.Power_28_Regular}" />
                    </Button>
                    <uix:SimpleStackPanel Spacing="5">
                        <ui:InfoBar
                            x:Name="birth"
                            d:IsOpen="False"
                            d:Message="🎉 今天是 XXX 的生日！"
                            ui:ThemeManager.RequestedTheme="Light"
                            IsClosable="False"
                            IsOpen="False"
                            Severity="Success" />
                        <Border
                            Padding="0"
                            d:Visibility="Collapsed"
                            ui:ThemeManager.RequestedTheme="Light"
                            Style="{StaticResource CardBorderStyle}"
                            Visibility="Collapsed">
                            <uix:SimpleStackPanel Margin="10" Spacing="5">
                                <TextBlock d:Text="本节课程:语文 11:30-12:40" FontSize="13" />
                                <TextBlock d:Text="下节课程:语文 11:30-12:40" FontSize="13" />
                            </uix:SimpleStackPanel>
                        </Border>
                        <Expander
                            x:Name="exp"
                            Padding="0"
                            d:Visibility="Visible"
                            FontSize="14"
                            Header="万年历"
                            Visibility="Collapsed">
                            <uix:SimpleStackPanel Margin="10">
                                <TextBlock
                                    x:Name="c1"
                                    MaxWidth="200"
                                    d:Text="今日宜:结婚.会亲友.打扫.买衣服.动土.祈福.安床.架马.祭祀.修造.放水.起基.成人礼.伐木.收养子女.开光.求子.上梁.竖柱.作梁.合帐"
                                    FontSize="13"
                                    Foreground="White" />
                                <TextBlock
                                    x:Name="c2"
                                    MaxWidth="200"
                                    d:Text="今日不宜:搬家.理发.搬新房.安门.作灶.开光"
                                    FontSize="13"
                                    Foreground="White" />
                            </uix:SimpleStackPanel>
                        </Expander>
                    </uix:SimpleStackPanel>
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition />
                            <RowDefinition />
                        </Grid.RowDefinitions>
                        <TextBlock
                            x:Name="VerStr"
                            Margin="5"
                            FontSize="14"
                            Foreground="White"
                            Text="CokeeClass 版本2.9.905.343">
                            <TextBlock.Effect>
                                <DropShadowEffect Opacity="0.3" />
                            </TextBlock.Effect>
                        </TextBlock>
                        <TextBlock
                            x:Name="slogan"
                            Grid.Row="1"
                            Margin="5"
                            FontSize="14"
                            Foreground="Tomato"
                            MouseRightButtonDown="Grid_MouseRightButtonDown"
                            Text="CokeeTech 秋坂科技 [参赛版本]">
                            <TextBlock.Effect>
                                <DropShadowEffect Opacity="0.3" />
                            </TextBlock.Effect>
                        </TextBlock>
                        <emoji:EmojiedTextBlock
                            HorizontalAlignment="Right"
                            VerticalAlignment="Center"
                            FontSize="19"
                            MouseRightButtonDown="Debug_RightBtn"
                            Text="⭐">
                            <emoji:EmojiedTextBlock.Effect>
                                <DropShadowEffect Opacity="0.3" />
                            </emoji:EmojiedTextBlock.Effect>
                        </emoji:EmojiedTextBlock>
                    </Grid>
                </uix:SimpleStackPanel>
            </uix:SimpleStackPanel>
        </Border>
        <Border
            Margin="0,60,0,0"
            HorizontalAlignment="Right"
            VerticalAlignment="Top">
            <ItemsControl
                x:Name="infos"
                Margin="0,20,0,0"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                d:ItemsSource="{d:SampleData ItemCount=10}">
                <ItemsControl.Resources>
                    <Storyboard x:Key="ShowInfoBar">
                        <!--  弹出动画：从InfoBar自身宽度位置（右侧隐藏）移动到0（可见）  -->
                        <DoubleAnimation
                            Storyboard.TargetProperty="RenderTransform.X"
                            From="{Binding ActualWidth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ui:InfoBar}}"
                            To="0"
                            Duration="0:0:0.6">
                            <DoubleAnimation.EasingFunction>
                                <BackEase EasingMode="EaseInOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                        <!--  收回动画：2秒后从0移回自身宽度位置（右侧隐藏）  -->
                        <DoubleAnimation
                            BeginTime="0:0:2.6"
                            Storyboard.TargetProperty="RenderTransform.X"
                            From="0"
                            To="{Binding ActualWidth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ui:InfoBar}}"
                            Duration="0:0:0.5">
                            <DoubleAnimation.EasingFunction>
                                <BackEase EasingMode="EaseInOut" />
                            </DoubleAnimation.EasingFunction>
                        </DoubleAnimation>
                    </Storyboard>
                </ItemsControl.Resources>
                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="{x:Type helper:Notification}">
                        <ui:InfoBar
                            Title="{Binding Title}"
                            MaxWidth="350"
                            MaxHeight="500"
                            Margin="10"
                            HorizontalAlignment="Right"
                            IsOpen="True"
                            Message="{Binding Content}"
                            Severity="{Binding Severity}"
                            Style="{StaticResource ThemeInfoBarBackground}">
                            <ui:InfoBar.Triggers>
                                <EventTrigger RoutedEvent="FrameworkElement.Loaded">
                                    <BeginStoryboard Storyboard="{StaticResource ShowInfoBar}" />
                                </EventTrigger>
                            </ui:InfoBar.Triggers>
                            <ui:InfoBar.RenderTransform>
                                <TranslateTransform X="{Binding ActualWidth, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ui:InfoBar}}" />
                            </ui:InfoBar.RenderTransform>
                        </ui:InfoBar>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </Border>
        <Popup
            x:Name="cardPopup"
            AllowsTransparency="True"
            KeyDown="MainWindow_OnKeyDown"
            Placement="Top"
            PlacementTarget="{Binding ElementName=floatGrid}"
            PopupAnimation="Fade"
            StaysOpen="False" />
        <Controls:RandomControl
            x:Name="rancor"
            Width="Auto"
            Height="300"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Visibility="Collapsed" />
        <Controls:RandomResult
            x:Name="ranres"
            Width="Auto"
            Height="500"
            HorizontalAlignment="Center"
            VerticalAlignment="Center"
            Background="{ui:AcrylicBrush}"
            Visibility="Collapsed" />
        <Controls:VolumeCard
            x:Name="volcd"
            Width="290"
            Margin="0,0,10,300"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            d:Visibility="Collapsed"
            Visibility="Collapsed" />
        <Controls:CourseCard
            x:Name="courseCard"
            d:IsHidden="True"
            d:Visibility="Visible"
            Background="#B2333333"
            Visibility="Collapsed" />
        <Grid
            x:Name="floatGrid"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            Focusable="False"
            MouseLeftButtonDown="FloatGrid_MouseDown"
            MouseLeftButtonUp="FloatGrid_MouseUp"
            MouseMove="FloatGrid_MouseMove"
            RenderTransformOrigin="0.5,0.5">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>
            <Grid.RenderTransform>
                <TransformGroup>
                    <TranslateTransform x:Name="transT" X="-10" Y="-100" />
                </TransformGroup>
            </Grid.RenderTransform>
            <Border
                x:Name="tipsBorder"
                Margin="3"
                Padding="0"
                HorizontalAlignment="Center"
                d:Visibility="Visible"
                CornerRadius="5"
                Style="{StaticResource CardBorderStyle}"
                Visibility="Collapsed">
                <TextBlock
                    x:Name="tipsText"
                    Margin="5"
                    d:Text="0000"
                    FontSize="11" />
            </Border>

            <ui:PersonPicture
                x:Name="head"
                Grid.Row="1"
                Width="80"
                Height="80"
                ProfilePicture="/Resources/head.jpg"
                RenderTransformOrigin="0.5,0.5">
                <ui:PersonPicture.Effect>
                    <DropShadowEffect Opacity="0.2" />
                </ui:PersonPicture.Effect>
                <ui:PersonPicture.RenderTransform>
                    <TransformGroup>
                        <RotateTransform x:Name="rotateT" Angle="0" />
                    </TransformGroup>
                </ui:PersonPicture.RenderTransform>
            </ui:PersonPicture>
            <ui:ProgressRing
                x:Name="progress"
                Grid.Row="1"
                Width="80"
                Height="80"
                IsActive="False"
                IsIndeterminate="False"
                StrokeThickness="2" />

            <Grid
                Grid.Row="1"
                Width="25"
                Height="25"
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom">
                <Grid.RenderTransform>
                    <ScaleTransform x:Name="iconTrans" d:ScaleX="1" d:ScaleY="1" CenterX="15" CenterY="15" ScaleX="0" ScaleY="0" />
                </Grid.RenderTransform>
                <Ellipse x:Name="iconE" Fill="White" />
                <ui:FontIcon
                    x:Name="icon"
                    Width="15"
                    Height="15"
                    Margin="5"
                    FontSize="15"
                    Foreground="Black"
                    Icon="{x:Static ui:FluentSystemIcons.Info_12_Regular}" />
            </Grid>
            <Border
                Grid.Row="2"
                Margin="3"
                Padding="0"
                Style="{StaticResource CardBorderStyle}">
                <TextBlock
                    x:Name="time"
                    Margin="5"
                    d:Text="11:11:11"
                    FontSize="14"
                    Text=""
                    TextAlignment="Center" />
            </Border>
        </Grid>
        <Border
            x:Name="logview"
            Width="520"
            Height="300"
            Margin="5"
            Padding="5"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            d:Visibility="Visible"
            Style="{StaticResource ThemeBackground}"
            Visibility="Collapsed">
            <Border.Background>
                <ImageBrush ImageSource="/Resources/CardBackground/1.png" />
            </Border.Background>
            <TabControl ui:TabControlHelper.IsAddTabButtonVisible="False">
                <TabItem
                    ui:TabItemHelper.Icon="{x:Static ui:FluentSystemIcons.TargetEdit_24_Regular}"
                    Background="{x:Null}"
                    Header="LogViewer"
                    IsSelected="True">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto" />
                            <RowDefinition />
                            <RowDefinition Height="Auto" />
                            <RowDefinition Height="Auto" />
                        </Grid.RowDefinitions>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="2*" />
                            </Grid.ColumnDefinitions>
                            <TextBlock Margin="5" Text="Debug Log Output" />
                            <ComboBox
                                x:Name="logItemBox"
                                Grid.Column="1"
                                Margin="0,0,10,0"
                                HorizontalAlignment="Right" />
                        </Grid>
                        <Controls:ScrollViewerEx Grid.Row="1" Margin="5">
                            <RichTextBox
                                x:Name="richTextBox"
                                Background="Black"
                                IsEnabled="False"
                                IsReadOnly="True" />
                        </Controls:ScrollViewerEx>
                        <TextBlock
                            x:Name="progressStr"
                            Grid.Row="2"
                            Margin="5"
                            Text="ETA:00:00:00 Rest 0 files with 0 dirs."
                            Visibility="Collapsed" />
                        <Button
                            Grid.Row="3"
                            Margin="5"
                            HorizontalAlignment="Stretch"
                            VerticalAlignment="Stretch"
                            Click="Button_Click"
                            Content="Exit" />
                    </Grid>
                </TabItem>
                <TabItem ui:TabItemHelper.Icon="{x:Static ui:FluentSystemIcons.Cut_24_Regular}" Header="TaskPanel">
                    <ui:Frame Source="/Views/Pages/Debug.xaml" />
                </TabItem>
            </TabControl>
        </Border>
        <Controls:UsbCard
            x:Name="usbCard"
            Margin="0,0,10,200"
            HorizontalAlignment="Right"
            VerticalAlignment="Bottom"
            d:IsHidden="True"
            d:Visibility="Visible" />
    </Grid>
</Window>